digraph AD_CrossDomain {
  rankdir=LR;
  node [shape=box, style=rounded];

  subgraph cluster_A {
    label="Domain A (Identity)";
    style=dashed;
    A_User [label="A\\john\nDN: CN=john,DC=domainA"];
    A_Kerberos [label="Kerberos Ticket\nSID: S-1-5-21-A"];
  }

  subgraph cluster_B {
    label="Domain B (Groups / Resources)";
    style=dashed;
    FSP_john [label="ForeignSecurityPrincipal\nDN: CN=S-1-5-21-A,\nCN=ForeignSecurityPrincipals,DC=domainB"];
    B_Group [label="Group\nDN: CN=Group,DC=domainB"];
    B_john [label="B\\john\nSID: S-1-5-21-B"];
  }

  A_User -> A_Kerberos [label="login"];
  A_Kerberos -> FSP_john [label="maps to SID"];
  FSP_john -> B_Group [label="member DN stored"];

  B_john -> B_Group [style=dotted, label="cannot substitute\n(different SID)"];
}

