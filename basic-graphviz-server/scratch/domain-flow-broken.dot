digraph AD_CrossDomain {
  rankdir=LR;
  node [shape=box, style=rounded];

  subgraph cluster_A {
    label="Domain A (User Identity)";
    style=dashed;
    A_User [label="A\\john\n(DN: CN=john,DC=domainA)"];
    A_Kerberos [label="Kerberos Ticket\n(SID: S-1-5-21-A-...)"];
  }

  subgraph cluster_B {
    label="Domain B (Resource / Group)";
    style=dashed;
    B_Group [label="Group\n(DN: CN=Group,DC=domainB)"];
    FSP_john [label="ForeignSecurityPrincipal\n(DN: CN=S-1-5-21-A...,CN=ForeignSecurityPrincipals,DC=domainB)"];
    B_john [label="B\\john\n(SID: S-1-5-21-B-...)"];
  }

  // Flow
  A_User -> A_Kerberos [label="login"];
  A_Kerberos -> FSP_john [label="authorization check"];
  FSP_john -> B_Group [label="member attribute updated"];
  
  // Optional: show why B\john cannot be used
  B_john -> B_Group [label="cannot be used (different SID)", style=dotted, color=red];

  // Layout hints
  { rank=same; A_Kerberos; FSP_john; }
}

